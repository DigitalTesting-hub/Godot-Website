<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Godot 3D MP LMS</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/lms.css">
    <link rel="stylesheet" href="css/admin.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="admin-page">
    <!-- Header -->
    <header>
        <div class="container">
            <nav>
                <div class="logo">GODOT 3D MP - ADMIN</div>
                
                <!-- Desktop Navigation -->
                <div class="nav-links">
                    <a href="#dashboard">Dashboard</a>
                    <a href="#courses">Courses</a>
                    <a href="#students">Students</a>
                </div>
                
                <!-- Admin User Menu -->
                <div class="user-menu">
                    <span id="adminEmail" class="user-email"></span>
                    <button id="adminLogoutBtn" class="cta-button logout-btn">Logout</button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Admin Dashboard -->
    <section id="dashboard" class="admin-dashboard">
        <div class="container">
            <div class="admin-header">
                <h1>Admin Dashboard</h1>
                <p>Welcome to the Godot 3D MP LMS Admin Panel</p>
            </div>

            <div class="admin-stats">
                <div class="stat-card">
                    <h3>Total Students</h3>
                    <span id="totalStudents" class="stat-number">0</span>
                </div>
                <div class="stat-card">
                    <h3>Total Courses</h3>
                    <span id="totalCourses" class="stat-number">0</span>
                </div>
                <div class="stat-card">
                    <h3>Active Courses</h3>
                    <span id="activeCourses" class="stat-number">0</span>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <h2>Quick Actions</h2>
                <div class="action-grid">
                    <button class="action-btn" onclick="showSection('courses')">
                        <span class="action-icon">ðŸ“š</span>
                        <span>Manage Courses</span>
                    </button>
                    <button class="action-btn" onclick="showSection('students')">
                        <span class="action-icon">ðŸ‘¥</span>
                        <span>Manage Students</span>
                    </button>
                    <button class="action-btn" onclick="openCourseModal()">
                        <span class="action-icon">âž•</span>
                        <span>Add New Course</span>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Courses Management -->
    <section id="courses" class="admin-section" style="display: none;">
        <div class="container">
            <div class="section-header">
                <h2>Course Management</h2>
                <button class="cta-button" onclick="openCourseModal()">+ Add New Course</button>
            </div>

            <div class="courses-list" id="adminCoursesList">
                <div class="placeholder-message">
                    <p>Loading courses...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Students Management -->
    <section id="students" class="admin-section" style="display: none;">
        <div class="container">
            <div class="section-header">
                <h2>Student Management</h2>
                <div class="search-box">
                    <input type="text" id="studentSearch" placeholder="Search students by email..." onkeyup="adminPanel.searchStudents(this.value)">
                </div>
            </div>

            <div class="students-list" id="studentsList">
                <div class="placeholder-message">
                    <p>Loading students...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Course Modal -->
    <div id="courseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="courseModalTitle">Add New Course</h3>
                <button class="close-btn" onclick="closeCourseModal()">âœ•</button>
            </div>
            <form id="courseForm" class="modal-form">
                <input type="hidden" id="courseId">
                <div class="form-group">
                    <label for="courseTitle">Course Title *</label>
                    <input type="text" id="courseTitle" required>
                </div>
                
                <div class="form-group">
                    <label for="courseDescription">Description *</label>
                    <textarea id="courseDescription" rows="4" required></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="courseTier">Required Tier *</label>
                        <select id="courseTier" required>
                            <option value="free">Free</option>
                            <option value="basic">Basic</option>
                            <option value="premium">Premium</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="coursePrice">Price (â‚¹) *</label>
                        <input type="number" id="coursePrice" step="100" min="0" value="0" required>
                    </div>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="courseActive" checked> Active Course
                    </label>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeCourseModal()">Cancel</button>
                    <button type="submit" class="cta-button">Save Course</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Chapter Management Modal -->
    <div id="chapterModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3 id="chapterModalTitle">Manage Chapters for: <span id="currentCourseTitle"></span></h3>
                <button class="close-btn" onclick="closeChapterModal()">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="chapters-list" id="chaptersList">
                    <div class="placeholder-message">
                        <p>Loading chapters...</p>
                    </div>
                </div>
                
                <div class="add-chapter-section" style="margin-top: 2rem; padding-top: 2rem; border-top: 1px solid rgba(255,255,255,0.1);">
                    <h4>Add New Chapter</h4>
                    <form id="chapterForm" class="modal-form">
                        <input type="hidden" id="chapterId">
                        <input type="hidden" id="chapterCourseId">
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="chapterTitle">Chapter Title *</label>
                                <input type="text" id="chapterTitle" required>
                            </div>
                            <div class="form-group">
                                <label for="chapterOrder">Chapter Order *</label>
                                <input type="number" id="chapterOrder" min="1" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="chapterDescription">Description</label>
                            <textarea id="chapterDescription" rows="3"></textarea>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="chapterVideoUrl">Video URL (Mux/YouTube)</label>
                                <input type="text" id="chapterVideoUrl" placeholder="mux.com/... or youtube.com/...">
                            </div>
                            <div class="form-group">
                                <label for="chapterDuration">Duration</label>
                                <input type="text" id="chapterDuration" placeholder="e.g., 15:30">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="chapterIsPremium"> Premium Content (Basic users cannot access)
                            </label>
                        </div>
                        
                        <div class="modal-actions">
                            <button type="button" class="btn-secondary" onclick="resetChapterForm()">Clear</button>
                            <button type="submit" class="cta-button">Save Chapter</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Student Details Modal -->
    <div id="studentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Student Details</h3>
                <button class="close-btn" onclick="closeStudentModal()">âœ•</button>
            </div>
            <div class="modal-body">
                <div id="studentDetails"></div>
            </div>
        </div>
    </div>

    <div id="adminMessage" class="form-message" style="display: none;"></div>

    <script src="js/admin.js"></script>
</body>
</html>
